---
phase: 03-ui-simplification
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - styles/css.py
  - app.py
  - tests/test_sidebar.py
autonomous: true

must_haves:
  truths:
    - "No sidebar visible on any screen size"
    - "User can enter query and receive response without any prior configuration"
    - "Comparison mode accessible via radio button in main content"
    - "LLM defaults to Gemini 2.0 Flash with no visible model selector"
  artifacts:
    - path: "styles/css.py"
      provides: "Sidebar hiding CSS"
      contains: "display: none"
    - path: "app.py"
      provides: "Simplified main app without sidebar"
      min_lines: 150
    - path: "tests/test_sidebar.py"
      provides: "Updated tests for new reality"
      min_lines: 10
  key_links:
    - from: "styles/css.py"
      to: "app.py"
      via: "get_base_css() import"
      pattern: "st\\.markdown\\(get_base_css\\(\\)"
---

<objective>
Remove the sidebar from Ra'd AI interface and simplify to a chatbox-only experience.

Purpose: Users should be able to ask financial questions without understanding data structure or configuring anything. The sidebar exposes unnecessary complexity (model selector, database info, column reference, filters) that conflicts with the "just ask" design goal.

Output: Clean chat-first interface where the sidebar is completely hidden and all navigation happens via radio buttons in the main content area.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-ui-simplification/03-RESEARCH.md

# Current files to modify
@styles/css.py
@app.py
@tests/test_sidebar.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add Sidebar Hiding CSS</name>
  <files>styles/css.py, app.py</files>
  <action>
1. In `styles/css.py`, add a new function `get_no_sidebar_css()` that returns CSS to hide the sidebar:
   ```python
   def get_no_sidebar_css() -> str:
       """CSS to completely hide the sidebar and its toggle."""
       return """
       <style>
       /* Hide sidebar completely */
       [data-testid="stSidebar"] {
           display: none !important;
       }
       /* Remove sidebar toggle button */
       [data-testid="collapsedControl"] {
           display: none !important;
       }
       </style>
       """
   ```

2. In `app.py`, update `st.set_page_config()` to add `initial_sidebar_state="collapsed"`:
   ```python
   st.set_page_config(
       page_title="Ra'd | Saudi Financial AI",
       page_icon="lightning_cloud",  # Use emoji name instead of literal
       layout="wide",
       initial_sidebar_state="collapsed",  # ADD THIS
   )
   ```

3. In `app.py`, import and apply the new CSS after existing CSS:
   - Add `get_no_sidebar_css` to imports from `styles.css`
   - Add `st.markdown(get_no_sidebar_css(), unsafe_allow_html=True)` after line 45
  </action>
  <verify>
Run the app with `streamlit run app.py` - sidebar should not be visible and no sidebar toggle icon should appear.
  </verify>
  <done>
Sidebar is completely hidden via CSS injection. No sidebar or toggle button visible on page load.
  </done>
</task>

<task type="auto">
  <name>Task 2: Remove Sidebar Code from app.py</name>
  <files>app.py</files>
  <action>
1. Remove the sidebar import (line 22):
   - DELETE: `from components.sidebar import render_sidebar`

2. Remove the sidebar render call and model_changed handling (lines 68-73):
   - DELETE: `model_changed = render_sidebar()`
   - DELETE: `if model_changed:` block

3. Remove advanced filters import and rendering (lines 90-96, 155-158):
   - DELETE: `from components.filters.advanced_filters import render_advanced_filters, apply_filters`
   - DELETE: `with st.sidebar:` block that renders filters
   - DELETE: `base_filters = filters if filters else None`
   - DELETE: The filter application logic (`if base_filters:` block)
   - DELETE: `st.sidebar.caption(...)` line

4. Clean up resulting unused variables:
   - The `base_filters` variable is no longer needed
   - The `filters` variable is no longer needed

Note: Keep the following unchanged:
   - Mode selector radio button (lines 102-109) - this is in main content, NOT sidebar
   - Data preview, example questions, chat history - all in main content
   - Comparison mode logic - accessed via radio button
  </action>
  <verify>
Run `python -c "import app"` - should import without errors. No references to `render_sidebar` or `render_advanced_filters` should remain.
  </verify>
  <done>
app.py no longer imports or calls any sidebar functions. Advanced filters removed. Mode selection remains via radio button in main content area.
  </done>
</task>

<task type="auto">
  <name>Task 3: Update Tests for Sidebar Removal</name>
  <files>tests/test_sidebar.py</files>
  <action>
1. Update `test_sidebar_css_prevents_truncation` to also verify sidebar hiding CSS:
   - Add assertions for `display: none` in the CSS
   - Rename to `test_sidebar_css_styling` to reflect broader scope

2. Remove or update tests that reference removed functions:
   - `test_dataset_descriptions_exist` - references `DATASET_DESCRIPTIONS` which no longer exists in sidebar.py
   - `test_get_dataset_quick_stats` - references `get_dataset_quick_stats` which no longer exists

3. Keep tests that still apply:
   - `test_get_dataset_info_keys` - tests data_loader, not sidebar
   - `test_database_info_can_be_collapsed` - keep if render_database_info still exists in sidebar.py

4. Add new test for sidebar hiding CSS:
   ```python
   def test_sidebar_hiding_css():
       """Test that CSS includes sidebar hiding rules."""
       from styles.css import get_no_sidebar_css

       css = get_no_sidebar_css()

       assert "[data-testid=\"stSidebar\"]" in css
       assert "display: none" in css
       assert "[data-testid=\"collapsedControl\"]" in css
   ```

5. Run tests to verify: `pytest tests/test_sidebar.py -v`
  </action>
  <verify>
`pytest tests/test_sidebar.py -v` passes with no import errors or failures.
  </verify>
  <done>
Tests updated to reflect sidebar removal. Old tests for removed functions deleted. New test for sidebar hiding CSS added. All tests pass.
  </done>
</task>

</tasks>

<verification>
After all tasks complete:

1. **Visual verification:**
   - Run `streamlit run app.py`
   - No sidebar visible
   - No sidebar toggle icon visible
   - Chat/Compare radio button visible in main content
   - Chat input works, queries route correctly

2. **Code verification:**
   - `grep -r "render_sidebar" app.py` returns nothing
   - `grep -r "render_advanced_filters" app.py` returns nothing
   - `grep -r "st.sidebar" app.py` returns nothing (except maybe in comments)

3. **Test verification:**
   - `pytest tests/test_sidebar.py -v` passes
   - `pytest tests/ -v` full suite passes
</verification>

<success_criteria>
1. No sidebar visible on any screen size (UI-01)
2. User can enter query and receive response without prior configuration (UI-02)
3. Comparison mode accessible via radio button in main content area (UI-03)
4. LLM defaults to Gemini 2.0 Flash - already implemented, verified by DEFAULT_MODEL in llm_config.py (UI-04)
5. All tests pass
</success_criteria>

<output>
After completion, create `.planning/phases/03-ui-simplification/03-01-SUMMARY.md`
</output>
